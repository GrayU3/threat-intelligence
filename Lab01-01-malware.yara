rule Lab01_01_Malware
{
    meta:
        description = "Detects Lab01-01.exe and Lab01-01.dll malware sample"
        author = "TheOneWithTheHammer"
        date = "2025-07-23"
        note = "Malware menggunakan API jaringan dan file system, serta mengandung IP dan nama DLL khas"

    strings:
        // Fungsi API yang diimpor
        $api1 = "CopyFile" ascii
        $api2 = "FindFirstFile" ascii
        $api3 = "FindNextFile" ascii
        $api4 = "CreateProcess" ascii
        $api5 = "Sleep" ascii
        $api6 = "connect" ascii
        $api7 = "socket" ascii

        // IP address mencurigakan
        $ip = "172.26.152.13"

        // Nama file atau string yang khas jika ada
        $dll_name = "Lab01-01.DLL" ascii

    condition:
        (uint16(0) == 0x5A4D) and // PE file
        (
            2 of ($api*) or
            $ip or
            $dll_name
        )
}
